.TH MSI_IONSTATPLOT 1 2025-Apr "" "Combined Statistical Plot and Mass Spectrometry Imaging Visualization Generates a composite visualization combining statistical charts (e.g., bar/box/violin plots) with mass spectrometry imaging (MSI) data. Outputs to specified PNG file with customizable layout."
.SH NAME
MSI_ionStatPlot \- MSI_ionStatPlot(mzpack, mz, met, sampleinfo,
    <i>savePng</i> = <span style='color: brown;'><strong>'./Rplot.png'</strong></span>,
    <i>ionName</i> = <span style='color: blue !important;'>NULL</span>,
    <i>size</i> = [<span style='color: green;'>1000</span>],
    <i>colorMap</i> = <span style='color: blue !important;'>NULL</span>,
    <i>MSI.colorset</i> = <span style='color: brown;'><strong>'viridis:turbo'</strong></span>,
    <i>ggStatPlot</i> = <span style='color: blue !important;'>NULL</span>,
    <i>padding.top</i> = <span style='color: green;'>150</span>,
    <i>padding.right</i> = <span style='color: green;'>200</span>,
    <i>padding.bottom</i> = <span style='color: green;'>150</span>,
    <i>padding.left</i> = <span style='color: green;'>150</span>,
    <i>interval</i> = <span style='color: green;'>50</span>,
    <i>combine.layout</i> = [<span style='color: green;'>5</span>],
    <i>jitter.size</i> = <span style='color: green;'>2</span>,
    <i>TrIQ</i> = <span style='color: green;'>0.65</span>,
    <i>backcolor</i> = <span style='color: #000000;'><strong>'black'</strong></span>,
    <i>regions</i> = <span style='color: blue !important;'>NULL</span>,
    <i>swap</i> = <span style='color: blue !important;'>FALSE</span>,
    <i>title.fontsize</i> = <span style='color: green;'>40</span>,
    <i>show.legend</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.grid</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.stats</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.axis.msi</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>tic.outline</i> = <span style='color: blue !important;'>NULL</span>)
.SH SYNOPSIS
\fIMSI_ionStatPlot(mzpack, mz, met, sampleinfo,
    <i>savePng</i> = <span style='color: brown;'><strong>'./Rplot.png'</strong></span>,
    <i>ionName</i> = <span style='color: blue !important;'>NULL</span>,
    <i>size</i> = [<span style='color: green;'>1000</span>],
    <i>colorMap</i> = <span style='color: blue !important;'>NULL</span>,
    <i>MSI.colorset</i> = <span style='color: brown;'><strong>'viridis:turbo'</strong></span>,
    <i>ggStatPlot</i> = <span style='color: blue !important;'>NULL</span>,
    <i>padding.top</i> = <span style='color: green;'>150</span>,
    <i>padding.right</i> = <span style='color: green;'>200</span>,
    <i>padding.bottom</i> = <span style='color: green;'>150</span>,
    <i>padding.left</i> = <span style='color: green;'>150</span>,
    <i>interval</i> = <span style='color: green;'>50</span>,
    <i>combine.layout</i> = [<span style='color: green;'>5</span>],
    <i>jitter.size</i> = <span style='color: green;'>2</span>,
    <i>TrIQ</i> = <span style='color: green;'>0.65</span>,
    <i>backcolor</i> = <span style='color: #000000;'><strong>'black'</strong></span>,
    <i>regions</i> = <span style='color: blue !important;'>NULL</span>,
    <i>swap</i> = <span style='color: blue !important;'>FALSE</span>,
    <i>title.fontsize</i> = <span style='color: green;'>40</span>,
    <i>show.legend</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.grid</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.stats</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>show.axis.msi</i> = <span style='color: blue !important;'>TRUE</span>,
    <i>tic.outline</i> = <span style='color: blue !important;'>NULL</span>)\fR
.SH OPTIONS
.PP
\fBmzpack\fB \fR\- . An mzpack object containing MS imaging data and layer information. Must be compatible with ggplot MS imaging functions.
.PP
.PP
\fBmz\fB \fR\- . Target ion mass-to-charge ratio (m/z) value for imaging.
.PP
.PP
\fBmet\fB \fR\- . List containing sample intensity data. List keys should be sample IDs with corresponding intensity values.
.PP
.PP
\fBsampleinfo\fB \fR\- . Metadata list defining sample groups and visualization properties. Requires: \itemize{ \item \code{group}: Character vector of group names (plot titles) \item \code{id}: Character vector of sample IDs corresponding to \code{met} keys \item \code{color}: HTML color codes for each group's statistical plot elements }
.PP
.PP
\fBsavePng\fB \fR\- './Rplot.png'. Output file path for PNG image. Default: "./Rplot.png".
.PP
.PP
\fBionName\fB \fR\- NULL. Display title for the ion. Uses m/z value when \code{NULL} (default).
.PP
.PP
\fBsize\fB \fR\- [2400, 1000]. Image dimensions in pixels [width, height]. Default: \code{c(2400, 1000)}.
.PP
.PP
\fBcolorMap\fB \fR\- NULL. Named list mapping group names to custom colors (overrides \code{sampleinfo$color}).
.PP
.PP
\fBMSI.colorset\fB \fR\- 'viridis:turbo'. 
.PP
.PP
\fBggStatPlot\fB \fR\- NULL. Statistical plot geometry function. Default: bar plot (\code{geom_barplot}).
.PP
.PP
\fBpadding.top\fB \fR\- 150. 
.PP
.PP
\fBpadding.right\fB \fR\- 200. 
.PP
.PP
\fBpadding.bottom\fB \fR\- 150. 
.PP
.PP
\fBpadding.left\fB \fR\- 150. 
.PP
.PP
\fBinterval\fB \fR\- 50. Spacing between statistical plot and MS image in pixels. Default: 50.
.PP
.PP
\fBcombine.layout\fB \fR\- [4, 5]. 
.PP
.PP
\fBjitter.size\fB \fR\- 2. 
.PP
.PP
\fBTrIQ\fB \fR\- 0.65. Intensity quantile threshold (0-1) for MS image enhancement. Default: 0.65.
.PP
.PP
\fBbackcolor\fB \fR\- 'black'. Background color for MS imaging panel. Default: "black".
.PP
.PP
\fBregions\fB \fR\- NULL. Optional list with spatial coordinates to overlay on MS image: \itemize{ \item \code{x}: X-coordinates vector \item \code{y}: Y-coordinates vector \item \code{colors}: Corresponding colors vector }
.PP
.PP
\fBswap\fB \fR\- FALSE. 
.PP
.PP
\fBtitle.fontsize\fB \fR\- 40. 
.PP
.PP
\fBshow.legend\fB \fR\- TRUE. 
.PP
.PP
\fBshow.grid\fB \fR\- TRUE. 
.PP
.PP
\fBshow.stats\fB \fR\- TRUE. 
.PP
.PP
\fBshow.axis.msi\fB \fR\- TRUE. 
.PP
.PP
\fBtic.outline\fB \fR\- NULL. 
.PP
.SH DETAILS
.PP
The function performs three main operations: 1. Computes ANOVA group statistics using \code{ANOVAGroup()} 2. Creates a statistical plot (bar/box/violin) with significance annotations 3. Generates MS ion image with optional spatial region overlays Plots are combined using a customizable split-layout system. Statistical tests include: - ANOVA global test (displayed in plot) - Pairwise t-tests against global mean (p-value symbols)
.PP
.SH FILES
.PP
SMRUCC/R#.declare_function.MSI_ionStatPlot at MSI_ionStatPlot.R:line 71
.PP
.SH COPYRIGHT
Copyright © xieguigang, MIT Licensed 2025
